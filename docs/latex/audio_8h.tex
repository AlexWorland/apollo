\doxysection{/\+Users/alexworland/auto\+Bitrate/apollo/src/audio.h File Reference}
\hypertarget{audio_8h}{}\label{audio_8h}\index{/Users/alexworland/autoBitrate/apollo/src/audio.h@{/Users/alexworland/autoBitrate/apollo/src/audio.h}}


Declarations for audio capture and encoding.  


{\ttfamily \#include "{}platform/common.\+h"{}}\newline
{\ttfamily \#include "{}thread\+\_\+safe.\+h"{}}\newline
{\ttfamily \#include "{}utility.\+h"{}}\newline
{\ttfamily \#include $<$bitset$>$}\newline
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structaudio_1_1opus__stream__config__t}{audio\+::opus\+\_\+stream\+\_\+config\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Opus stream configuration structure. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structaudio_1_1stream__params__t}{audio\+::stream\+\_\+params\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Stream parameters structure. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structaudio_1_1config__t}{audio\+::config\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Audio configuration structure. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structaudio_1_1audio__ctx__t}{audio\+::audio\+\_\+ctx\+\_\+t}}
\begin{DoxyCompactList}\small\item\em Audio context structure. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
using \mbox{\hyperlink{audio_8h_a208536a48fedc9bee7a37c20450347fe}{audio\+::buffer\+\_\+t}} = \mbox{\hyperlink{classutil_1_1buffer__t}{util\+::buffer\+\_\+t}}$<$std\+::uint8\+\_\+t$>$
\begin{DoxyCompactList}\small\item\em Audio buffer type. \end{DoxyCompactList}\item 
using \mbox{\hyperlink{audio_8h_abe0a730704a0bf6b80dcc8f75d704ffd}{audio\+::packet\+\_\+t}} = std\+::pair$<$void \texorpdfstring{$\ast$}{*}, \mbox{\hyperlink{audio_8h_a208536a48fedc9bee7a37c20450347fe}{buffer\+\_\+t}}$>$
\begin{DoxyCompactList}\small\item\em Audio packet type. \end{DoxyCompactList}\item 
using \mbox{\hyperlink{audio_8h_aa090183dda3ff69e10765b34e048a6a9}{audio\+::audio\+\_\+ctx\+\_\+ref\+\_\+t}} = \mbox{\hyperlink{classsafe_1_1shared__t}{safe\+::shared\+\_\+t}}$<$\mbox{\hyperlink{structaudio_1_1audio__ctx__t}{audio\+\_\+ctx\+\_\+t}}$>$\+::ptr\+\_\+t
\begin{DoxyCompactList}\small\item\em Audio context reference type. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9}{audio\+::stream\+\_\+config\+\_\+e}} \+: int \{ \newline
\mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a7890cc01d9ec2540b6330a25365ddbc5}{audio\+::\+STEREO}}
, \mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a2c8d41b662fa736c28187960d05f773e}{audio\+::\+HIGH\+\_\+\+STEREO}}
, \mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a76bdfe77a1e4a8ea436c099112beba8f}{audio\+::\+SURROUND51}}
, \mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a98f7c38e4754dc0f21a5ea7a689ba7d4}{audio\+::\+HIGH\+\_\+\+SURROUND51}}
, \newline
\mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9ad09001a7ffb508cb770ff3907be15c7b}{audio\+::\+SURROUND71}}
, \mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a8d647db81d57921ec933c5cf6b9fd0cb}{audio\+::\+HIGH\+\_\+\+SURROUND71}}
, \mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9aea5748c50c878b9d1f90504c4d377a3d}{audio\+::\+MAX\+\_\+\+STREAM\+\_\+\+CONFIG}}
 \}
\begin{DoxyCompactList}\small\item\em Audio stream configuration enumeration. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{audio_8cpp_a50f4f1627a2b1c7ae2021dd0dbf21b03}{audio\+::capture}} (safe\+::mail\+\_\+t \mbox{\hyperlink{namespacemail}{mail}}, \mbox{\hyperlink{structaudio_1_1config__t}{config\+\_\+t}} config, void \texorpdfstring{$\ast$}{*}channel\+\_\+data)
\begin{DoxyCompactList}\small\item\em Capture audio from the system and encode it. \end{DoxyCompactList}\item 
\mbox{\hyperlink{audio_8h_aa090183dda3ff69e10765b34e048a6a9}{audio\+\_\+ctx\+\_\+ref\+\_\+t}} \mbox{\hyperlink{audio_8cpp_acf6045021b53fd7c6583fe9ac2740fbe}{audio\+::get\+\_\+audio\+\_\+ctx\+\_\+ref}} ()
\begin{DoxyCompactList}\small\item\em Get the reference to the audio context. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{audio_8cpp_a7ca978d7523c30309defd31a66d1654c}{audio\+::is\+\_\+audio\+\_\+ctx\+\_\+sink\+\_\+available}} (const \mbox{\hyperlink{structaudio_1_1audio__ctx__t}{audio\+\_\+ctx\+\_\+t}} \&ctx)
\begin{DoxyCompactList}\small\item\em Check if the audio sink held by audio context is available. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Declarations for audio capture and encoding. 



\label{doc-typedef-members}
\Hypertarget{audio_8h_doc-typedef-members}
\doxysubsection{Typedef Documentation}
\Hypertarget{audio_8h_aa090183dda3ff69e10765b34e048a6a9}\index{audio.h@{audio.h}!audio\_ctx\_ref\_t@{audio\_ctx\_ref\_t}}
\index{audio\_ctx\_ref\_t@{audio\_ctx\_ref\_t}!audio.h@{audio.h}}
\doxysubsubsection{\texorpdfstring{audio\_ctx\_ref\_t}{audio\_ctx\_ref\_t}}
{\footnotesize\ttfamily \label{audio_8h_aa090183dda3ff69e10765b34e048a6a9} 
using \mbox{\hyperlink{audio_8h_aa090183dda3ff69e10765b34e048a6a9}{audio\+::audio\+\_\+ctx\+\_\+ref\+\_\+t}} = \mbox{\hyperlink{classsafe_1_1shared__t}{safe\+::shared\+\_\+t}}$<$audio\+\_\+ctx\+\_\+t$>$\+::ptr\+\_\+t}



Audio context reference type. 

Shared pointer reference to audio context for managing audio sink lifecycle. \Hypertarget{audio_8h_a208536a48fedc9bee7a37c20450347fe}\index{audio.h@{audio.h}!buffer\_t@{buffer\_t}}
\index{buffer\_t@{buffer\_t}!audio.h@{audio.h}}
\doxysubsubsection{\texorpdfstring{buffer\_t}{buffer\_t}}
{\footnotesize\ttfamily \label{audio_8h_a208536a48fedc9bee7a37c20450347fe} 
using \mbox{\hyperlink{audio_8h_a208536a48fedc9bee7a37c20450347fe}{audio\+::buffer\+\_\+t}} = \mbox{\hyperlink{classutil_1_1buffer__t}{util\+::buffer\+\_\+t}}$<$std\+::uint8\+\_\+t$>$}



Audio buffer type. 

Buffer for storing raw audio data as bytes. \Hypertarget{audio_8h_abe0a730704a0bf6b80dcc8f75d704ffd}\index{audio.h@{audio.h}!packet\_t@{packet\_t}}
\index{packet\_t@{packet\_t}!audio.h@{audio.h}}
\doxysubsubsection{\texorpdfstring{packet\_t}{packet\_t}}
{\footnotesize\ttfamily \label{audio_8h_abe0a730704a0bf6b80dcc8f75d704ffd} 
using \mbox{\hyperlink{audio_8h_abe0a730704a0bf6b80dcc8f75d704ffd}{audio\+::packet\+\_\+t}} = std\+::pair$<$void \texorpdfstring{$\ast$}{*}, buffer\+\_\+t$>$}



Audio packet type. 

Pair of channel data pointer and audio buffer containing encoded audio data. 

\label{doc-enum-members}
\Hypertarget{audio_8h_doc-enum-members}
\doxysubsection{Enumeration Type Documentation}
\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9}\index{audio.h@{audio.h}!stream\_config\_e@{stream\_config\_e}}
\index{stream\_config\_e@{stream\_config\_e}!audio.h@{audio.h}}
\doxysubsubsection{\texorpdfstring{stream\_config\_e}{stream\_config\_e}}
{\footnotesize\ttfamily \label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9} 
enum \mbox{\hyperlink{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9}{audio\+::stream\+\_\+config\+\_\+e}} \+: int}



Audio stream configuration enumeration. 

Defines available audio stream configurations for different channel layouts and quality levels. \begin{DoxyEnumFields}[2]{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{STEREO@{STEREO}!audio.h@{audio.h}}\index{audio.h@{audio.h}!STEREO@{STEREO}}}\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a7890cc01d9ec2540b6330a25365ddbc5}\label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a7890cc01d9ec2540b6330a25365ddbc5} 
STEREO&Stereo. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{HIGH\_STEREO@{HIGH\_STEREO}!audio.h@{audio.h}}\index{audio.h@{audio.h}!HIGH\_STEREO@{HIGH\_STEREO}}}\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a2c8d41b662fa736c28187960d05f773e}\label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a2c8d41b662fa736c28187960d05f773e} 
HIGH\+\_\+\+STEREO&High stereo. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SURROUND51@{SURROUND51}!audio.h@{audio.h}}\index{audio.h@{audio.h}!SURROUND51@{SURROUND51}}}\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a76bdfe77a1e4a8ea436c099112beba8f}\label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a76bdfe77a1e4a8ea436c099112beba8f} 
SURROUND51&Surround 5.\+1. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{HIGH\_SURROUND51@{HIGH\_SURROUND51}!audio.h@{audio.h}}\index{audio.h@{audio.h}!HIGH\_SURROUND51@{HIGH\_SURROUND51}}}\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a98f7c38e4754dc0f21a5ea7a689ba7d4}\label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a98f7c38e4754dc0f21a5ea7a689ba7d4} 
HIGH\+\_\+\+SURROUND51&High surround 5.\+1. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{SURROUND71@{SURROUND71}!audio.h@{audio.h}}\index{audio.h@{audio.h}!SURROUND71@{SURROUND71}}}\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9ad09001a7ffb508cb770ff3907be15c7b}\label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9ad09001a7ffb508cb770ff3907be15c7b} 
SURROUND71&Surround 7.\+1. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{HIGH\_SURROUND71@{HIGH\_SURROUND71}!audio.h@{audio.h}}\index{audio.h@{audio.h}!HIGH\_SURROUND71@{HIGH\_SURROUND71}}}\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a8d647db81d57921ec933c5cf6b9fd0cb}\label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9a8d647db81d57921ec933c5cf6b9fd0cb} 
HIGH\+\_\+\+SURROUND71&High surround 7.\+1. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{MAX\_STREAM\_CONFIG@{MAX\_STREAM\_CONFIG}!audio.h@{audio.h}}\index{audio.h@{audio.h}!MAX\_STREAM\_CONFIG@{MAX\_STREAM\_CONFIG}}}\Hypertarget{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9aea5748c50c878b9d1f90504c4d377a3d}\label{audio_8h_ac92552a5fdc9c1f75dfca4542c7f3cd9aea5748c50c878b9d1f90504c4d377a3d} 
MAX\+\_\+\+STREAM\+\_\+\+CONFIG&Maximum audio stream configuration. \\
\hline

\end{DoxyEnumFields}


\label{doc-func-members}
\Hypertarget{audio_8h_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{audio_8cpp_a50f4f1627a2b1c7ae2021dd0dbf21b03}\index{audio.h@{audio.h}!capture@{capture}}
\index{capture@{capture}!audio.h@{audio.h}}
\doxysubsubsection{\texorpdfstring{capture()}{capture()}}
{\footnotesize\ttfamily \label{audio_8cpp_a50f4f1627a2b1c7ae2021dd0dbf21b03} 
void audio\+::capture (\begin{DoxyParamCaption}\item[{safe\+::mail\+\_\+t}]{mail}{, }\item[{\mbox{\hyperlink{structaudio_1_1config__t}{config\+\_\+t}}}]{config}{, }\item[{void \texorpdfstring{$\ast$}{*}}]{channel\+\_\+data}{}\end{DoxyParamCaption})}



Capture audio from the system and encode it. 

Captures audio from the selected audio sink, encodes it using Opus, and sends encoded packets through the mail system.


\begin{DoxyParams}{Parameters}
{\em mail} & Mail system for communication and packet delivery. \\
\hline
{\em config} & Audio configuration including channels, quality, and flags. \\
\hline
{\em channel\+\_\+data} & Channel-\/specific data pointer to include with packets. \\
\hline
\end{DoxyParams}
\Hypertarget{audio_8cpp_acf6045021b53fd7c6583fe9ac2740fbe}\index{audio.h@{audio.h}!get\_audio\_ctx\_ref@{get\_audio\_ctx\_ref}}
\index{get\_audio\_ctx\_ref@{get\_audio\_ctx\_ref}!audio.h@{audio.h}}
\doxysubsubsection{\texorpdfstring{get\_audio\_ctx\_ref()}{get\_audio\_ctx\_ref()}}
{\footnotesize\ttfamily \label{audio_8cpp_acf6045021b53fd7c6583fe9ac2740fbe} 
audio\+\_\+ctx\+\_\+ref\+\_\+t audio\+::get\+\_\+audio\+\_\+ctx\+\_\+ref (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Get the reference to the audio context. 

\begin{DoxyReturn}{Returns}
A shared pointer reference to audio context. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
Aside from the configuration purposes, it can be used to extend the audio sink lifetime to capture sink earlier and restore it later.
\end{DoxyNote}
@examples audio\+\_\+ctx\+\_\+ref\+\_\+t audio = get\+\_\+audio\+\_\+ctx\+\_\+ref() @examples\+\_\+end \Hypertarget{audio_8cpp_a7ca978d7523c30309defd31a66d1654c}\index{audio.h@{audio.h}!is\_audio\_ctx\_sink\_available@{is\_audio\_ctx\_sink\_available}}
\index{is\_audio\_ctx\_sink\_available@{is\_audio\_ctx\_sink\_available}!audio.h@{audio.h}}
\doxysubsubsection{\texorpdfstring{is\_audio\_ctx\_sink\_available()}{is\_audio\_ctx\_sink\_available()}}
{\footnotesize\ttfamily \label{audio_8cpp_a7ca978d7523c30309defd31a66d1654c} 
bool audio\+::is\+\_\+audio\+\_\+ctx\+\_\+sink\+\_\+available (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structaudio_1_1audio__ctx__t}{audio\+\_\+ctx\+\_\+t}} \&}]{ctx}{}\end{DoxyParamCaption})}



Check if the audio sink held by audio context is available. 

\begin{DoxyReturn}{Returns}
True if available (and can probably be restored), false otherwise. 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
Useful for delaying the release of audio context shared pointer (which tries to restore original sink).
\end{DoxyNote}
@examples audio\+\_\+ctx\+\_\+ref\+\_\+t audio = get\+\_\+audio\+\_\+ctx\+\_\+ref() if (audio.\+get()) \{ return is\+\_\+audio\+\_\+ctx\+\_\+sink\+\_\+available(\texorpdfstring{$\ast$}{*}audio.get()); \} return false; @examples\+\_\+end 